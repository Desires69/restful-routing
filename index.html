<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>RestfulRouting, Rails-style routing for ASP.NET MVC 2!</title>
    <link href="stylesheets/application.css" media="all" rel="stylesheet" type="text/css"/><link href="stylesheets/twilight.css" media="all" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <div id="container">
      <div id="box">
        <section>
          <header>
            <h1>restful-routing</h1>
          </header>
        </section>
        <section>
          <p>RestfulRouting is a routing library for <span class="caps">ASP</span>.<span class="caps">NET</span> <span class="caps">MVC</span> based on the <a href="http://edgeguides.rubyonrails.org/routing.html">Rails 3 routing <span class="caps">DSL</span></a>.</p>
          <h1>Links</h1>
          <ul>
            <li>
              <a href="http://github.com/stevehodgkiss/restful-routing">Source</a>
            </li>
            <li>
              <a href="http://github.com/stevehodgkiss/restful-routing/issues">Issues</a>
            </li>
          </ul>
          <h1>Table of Contents</h1>
          <ul>
            <li>
              <a href="#example">Example</a>
            </li>
            <li>
              <a href="#gettingstarted">Getting started</a>
            </li>
            <li>
              <a href="#therouteset">The RouteSet</a>
            </li>
            <li>
              <a href="#mappingresources">Mapping resources</a>
              <ul>
                <li>
                  <a href="#resource">Resource</a>
                </li>
                <li>
                  <a href="#resources">Resources</a>
                </li>
              </ul>
            </li>
            <li>
              <a href="#routeconfiguration">Route configuration</a>
            </li>
            <li>
              <a href="#membercollection">Member and collection routes</a>
            </li>
            <li>
              <a href="#areas">Areas</a>
            </li>
            <li>
              <a href="#restfulroutingviewengine">RestfulRoutingViewEngine</a>
            </li>
            <li>
              <a href="#connectingroutesets">Connecting RouteSet's together</a>
            </li>
            <li>
              <a href="#standardmappings">Standard mappings</a>
            </li>
          </ul>
          <h1>
            <a name="example">Example</a>
          </h1>
          <pre class="twilight"><span class="Keyword">public</span> <span class="Storage">class</span> Routes : RouteSet&#x000A;{&#x000A;  <span class="Keyword">public</span> Routes()&#x000A;  {&#x000A;    Resource&lt;SessionsController&gt;();&#x000A;    Resources&lt;BlogsController&gt;(() =&gt;&#x000A;    {&#x000A;      As(<span class="String"><span class="String">&quot;</span>weblogs<span class="String">&quot;</span></span>);&#x000A;      Only(<span class="String"><span class="String">&quot;</span>index<span class="String">&quot;</span></span>, <span class="String"><span class="String">&quot;</span>show<span class="String">&quot;</span></span>);&#x000A;      Collection(<span class="String"><span class="String">&quot;</span>latest<span class="String">&quot;</span></span>, HttpVerbs.Get);&#x000A;&#x000A;      Resources&lt;PostsController&gt;(() =&gt;&#x000A;      {&#x000A;        Except(<span class="String"><span class="String">&quot;</span>create<span class="String">&quot;</span></span>, <span class="String"><span class="String">&quot;</span>update<span class="String">&quot;</span></span>, <span class="String"><span class="String">&quot;</span>destroy<span class="String">&quot;</span></span>);&#x000A;        Resources&lt;CommentsController&gt;(() =&gt; Except(<span class="String"><span class="String">&quot;</span>destroy<span class="String">&quot;</span></span>));&#x000A;      });&#x000A;    });&#x000A;  }&#x000A;}&#x000A;&#x000A;<span class="Comment"><span class="Comment">//</span> Global.asax.cs</span>&#x000A;<span class="Keyword">public</span> <span class="Storage">class</span> MvcApplication : System.Web.HttpApplication&#x000A;{&#x000A;  <span class="Keyword">protected</span> <span class="Keyword">void</span> Application_Start()&#x000A;  {&#x000A;    ViewEngines.Engines.Clear();&#x000A;    ViewEngines.Engines.Add(<span class="Keyword">new</span> RestfulRoutingViewEngine());&#x000A;&#x000A;    RouteTable.Routes.MapRoutes&lt;Routes&gt;();&#x000A;  }&#x000A;}&#x000A;</pre>
          <h1>
            <a name="gettingstarted">Getting started</a>
          </h1>
          <p>Clone the <a href="http://github.com/stevehodgkiss/restful-routing">repository</a> and run rake. This will compile and test the project. Now go to the build folder and grab the 2 assemblies you need to reference from your project.</p>
          <pre class='twilight'>git clone git://github.com/stevehodgkiss/restful-routing.git&#x000A;cd restful-routing&#x000A;rake&#x000A;</pre>
          <h1>
            <a name="therouteset">The RouteSet</a>
          </h1>
          <p>All routes are defined inside the constructor of a class which inherits from RouteSet. You can then connect the main RouteSet to your application routes using RouteTable.Routes.MapRoutes<MyRouteSet>().</p>
          <h1>
            <a name="mappingresources">Mapping Resources</a>
          </h1>
          <p>There are 2 types of resource mappings that you can use. <code>Resource&lt;TController&gt;()</code> and <code>Resources&lt;TController&gt;()</code> (Notice the pluralization). Resources maps a collection of resources. Resource maps a singleton. The two main differences are that Resource doesn&#8217;t have an {id} route parameter, and it doesn&#8217;t have an index.</p>
          <h2>
            <a name="resource">Resource</a>
          </h2>
          <p>This maps a sessions resource as a singleton which has a nested avatars singleton resource.</p>
          <pre class="twilight">Resource&lt;SessionsController&gt;(() =&gt;&#x000A;{&#x000A;  Resource&lt;AvatarsController&gt;();&#x000A;});&#x000A;</pre>
          <p>The RouteTable will look like this with the above mapping:</p>
          <table>
          	<tr>
          		<td> Http Method </td>
          		<td> Path                </td>
          		<td> Endpoint (controller#action) </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> session             </td>
          		<td> sessions#show                </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">POST</span>        </td>
          		<td> session             </td>
          		<td> sessions#create              </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> session/new         </td>
          		<td> sessions#new                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> session/edit        </td>
          		<td> sessions#edit                </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">PUT</span>         </td>
          		<td> session             </td>
          		<td> sessions#update              </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">DELETE</span>      </td>
          		<td> session             </td>
          		<td> sessions#destroy             </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> session/avatar      </td>
          		<td> avatars#show                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">POST</span>        </td>
          		<td> session/avatar      </td>
          		<td> avatars#create               </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> session/avatar/new  </td>
          		<td> avatars#new                  </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> session/avatar/edit </td>
          		<td> avatars#edit                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">PUT</span>         </td>
          		<td> session/avatar      </td>
          		<td> avatars#update               </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">DELETE</span>      </td>
          		<td> session/avatar      </td>
          		<td> avatars#destroy              </td>
          	</tr>
          </table>
          <h2>
            <a name="resources">Resources</a>
          </h2>
          <p>
            This maps a blogs resource with a nested posts resource.
          </p>
          <pre class="twilight">Resources&lt;BlogsController&gt;(() =&gt;&#x000A;{&#x000A;  Resources&lt;PostsController&gt;();&#x000A;});&#x000A;</pre>
          <p>The RouteTable will have routes which look like this with the above mapping:</p>
          <table>
          	<tr>
          		<td> Http Method </td>
          		<td> Path                           </td>
          		<td> Endpoint (controller#action) </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs                          </td>
          		<td> blogs#index                  </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">POST</span>        </td>
          		<td> blogs                          </td>
          		<td> blogs#create                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/{id}                     </td>
          		<td> blogs#show                   </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/new                      </td>
          		<td> blogs#new                    </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/{id}/edit                </td>
          		<td> blogs#edit                   </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">PUT</span>         </td>
          		<td> blogs/{id}                     </td>
          		<td> blogs#update                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">DELETE</span>      </td>
          		<td> blogs/{id}                     </td>
          		<td> blogs#destroy                </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/{blogId}/posts           </td>
          		<td> posts#index                  </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">POST</span>        </td>
          		<td> blogs/{blogId}/posts           </td>
          		<td> posts#create                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/{blogId}/posts/{id}      </td>
          		<td> posts#show                   </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/{blogId}/posts/new       </td>
          		<td> posts#new                    </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">GET</span>         </td>
          		<td> blogs/{blogId}/posts/{id}/edit </td>
          		<td> posts#edit                   </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">PUT</span>         </td>
          		<td> blogs/{blogId}/posts/{id}      </td>
          		<td> posts#update                 </td>
          	</tr>
          	<tr>
          		<td> <span class="caps">DELETE</span>      </td>
          		<td> blogs/{blogId}/posts/{id}      </td>
          		<td> posts#destroy                </td>
          	</tr>
          </table>
          <h1>
            <a name="routeconfiguration">Route configuration</a>
          </h1>
          <p>
            You can adjust the behaviour of a given resource mapping in the context of it's nested action parameter.
          </p>
          <pre class="twilight">Resources&lt;PostsController&gt;(() =&gt; {&#x000A;  As(<span class="String"><span class="String">&quot;</span>weblogs<span class="String">&quot;</span></span>); <span class="Comment"><span class="Comment">//</span> changes the path name to weblogs</span>&#x000A;  Only(<span class="String"><span class="String">&quot;</span>index<span class="String">&quot;</span></span>, <span class="String"><span class="String">&quot;</span>show<span class="String">&quot;</span></span>) <span class="Comment"><span class="Comment">//</span> only maps the index and show actions</span>&#x000A;  Except(<span class="String"><span class="String">&quot;</span>destroy<span class="String">&quot;</span></span>) <span class="Comment"><span class="Comment">//</span> maps all actions except destroy</span>&#x000A;  Constrain(<span class="String"><span class="String">&quot;</span>id<span class="String">&quot;</span></span>, <span class="String"><span class="String">&quot;</span><span class="StringConstant">\d</span>+<span class="String">&quot;</span></span>); <span class="Comment"><span class="Comment">//</span> constrains the id to digits</span>&#x000A;});&#x000A;</pre>
          <h1>
            <a name="membercollection">Member and collection routes</a>
          </h1>
          <p>Use the Member and Collection methods inside the resource to add routes to the collection (without an id route parameter) or the member (with an id route parameter). Methods available to map are Get, Post, Put, Delete and Head.</p>
          <pre class="twilight">Resources&lt;PostsController&gt;(() =&gt; {&#x000A;  Collection(x =&gt; {&#x000A;    x.Get(<span class="String"><span class="String">&quot;</span>latest<span class="String">&quot;</span></span>); <span class="Comment"><span class="Comment">//</span> GET posts/latest =&gt; posts#latest</span>&#x000A;    x.Put(<span class="String"><span class="String">&quot;</span>someaction<span class="String">&quot;</span></span>) <span class="Comment"><span class="Comment">//</span> PUT posts/someaction =&gt; posts#someaction</span>&#x000A;  });&#x000A;  Member(x =&gt; x.Post(<span class="String"><span class="String">&quot;</span>like<span class="String">&quot;</span></span>)); <span class="Comment"><span class="Comment">//</span> POST posts/1/like =&gt; posts#like(1)</span>&#x000A;});&#x000A;</pre>
          <h1>
            <a name="areas">Areas</a>
          </h1>
          <pre class="twilight">Area&lt;Controllers.Admin.BlogsController&gt;(<span class="String"><span class="String">&quot;</span>admin<span class="String">&quot;</span></span>, () =&gt;&#x000A;{&#x000A;  Resources&lt;BlogsController&gt;(() =&gt;&#x000A;  {&#x000A;    Resources&lt;PostsController&gt;(() =&gt;&#x000A;    {&#x000A;      Resources&lt;CommentsController&gt;();&#x000A;    });&#x000A;  });&#x000A;});&#x000A;</pre>
          <p>This maps an area called admin and will only look for controllers located in the Controllers.Admin namespace. You can specify that the whole RouteSet is to be put into an area without putting a path prefix on the mapping. The following would just constrain all the routes to the namespace of BlogsController, but still look for views based on the area name blogs.</p>
          <pre class="twilight">Area&lt;BlogsController&gt;(<span class="String"><span class="String">&quot;</span>blogs<span class="String">&quot;</span></span>);&#x000A;</pre>
          <h1>
            <a name="restfulroutingviewengine">RestfulRoutingViewEngine</a>
          </h1>
          <p>RestfulRoutingViewEngine inherits from WebFormsViewEngine and changes where it looks for area views slightly. It changes it from {area}/Views/{controller}/{action} to Views/{area}/{controller}/{action}.</p>
          <h1>
            <a name="connectingroutesets">Connecting RouteSets together</a>
          </h1>
          <p>
            The connect method allows you to pull in routes from another routeset.
          </p>
          <pre class="twilight"><span class="Keyword">public</span> <span class="Storage">class</span> BlogRoutes : RouteSet&#x000A;{&#x000A;  <span class="Keyword">public</span> BlogRoutes()&#x000A;  {&#x000A;    Area&lt;BlogsController&gt;(<span class="String"><span class="String">&quot;</span>blogs<span class="String">&quot;</span></span>);&#x000A;    Resources&lt;BlogsController&gt;();&#x000A;    Resources&lt;PostsController&gt;();&#x000A;  }&#x000A;}&#x000A;&#x000A;<span class="Keyword">public</span> <span class="Storage">class</span> Routes : RouteSet&#x000A;{&#x000A;  <span class="Keyword">public</span> Routes()&#x000A;  {&#x000A;    <span class="Comment"><span class="Comment">//</span> maps the BlogRoutes route set without a path prefix.</span>&#x000A;    Connect&lt;BlogRoutes&gt;(<span class="String"><span class="String">&quot;</span><span class="String">&quot;</span></span>);&#x000A;  }&#x000A;}&#x000A;&#x000A;<span class="Comment"><span class="Comment">//</span> Application_Start()</span>&#x000A;RouteTable.Routes.MapRoutes&lt;Routes&gt;();&#x000A;</pre>
          <h1>
            <a name="standardmappings">Standard mappings</a>
          </h1>
          <p>Two additional methods are provided so you can add custom routes to the route set if you need to. Map is a chainable method that allows you to add standard mappings. Route is a method that will allow you to add a custom route to the route set.</p>
          <pre class="twilight">Map(<span class="String"><span class="String">&quot;</span>posts/{year}/{slug}<span class="String">&quot;</span></span>)&#x000A;  .To&lt;PostsController&gt;(x =&gt; x.Post(-<span class="Constant">1</span>, <span class="String"><span class="String">&quot;</span><span class="String">&quot;</span></span>))&#x000A;  .Constrain(<span class="String"><span class="String">&quot;</span>slug<span class="String">&quot;</span></span>, @<span class="String"><span class="String">&quot;</span><span class="StringConstant">\w</span>+<span class="String">&quot;</span></span>)&#x000A;  .Constrain(<span class="String"><span class="String">&quot;</span>year<span class="String">&quot;</span></span>, @<span class="String"><span class="String">&quot;</span><span class="StringConstant">\d</span>+<span class="String">&quot;</span></span>);&#x000A;Route(<span class="Keyword">new</span> Route(<span class="String"><span class="String">&quot;</span>posts/{action}<span class="String">&quot;</span></span>, &#x000A;  <span class="Keyword">new</span> RouteValueDictionary(<span class="Keyword">new</span> { controller = <span class="String"><span class="String">&quot;</span>posts<span class="String">&quot;</span></span> }), &#x000A;  <span class="Keyword">new</span> MvcRouteHandler());&#x000A;</pre>
        </section>
        <footer>
          <div id="resharper">
            <span>
              Can't code without
            </span>
            <a alt="The best C# &amp; VB.NET refactoring plugin for Visual Studio" href="http://www.jetbrains.com/resharper/features/code_refactoring.html" title="The best C# &amp; VB.NET refactoring plugin for Visual Studio">
              The best C# & VB.NET refactoring plugin for Visual Studio
            </a>
          </div>
        </footer>
      </div>
    </div>
    <a href="http://github.com/stevehodgkiss/restful-routing" id="github">
      <img src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" />
    </a>
  </body>
</html>
